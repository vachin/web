@(injectMUI: Boolean = false)
<footer class="page-footer light-blue lighten-1">
    <div class="footer-copyright">
        <div class="container">
            Â© 2017 Vachin
            <div class="right">
                <a class="grey-text text-lighten-4" href="#!">Privacy</a> &nbsp; <a class="grey-text text-lighten-4" href="#!">Terms</a> &nbsp; <a class="grey-text text-lighten-4" href="#!">Contact</a>
            </div>
        </div>
    </div>
</footer>
<script src="@routes.Assets.at("javascripts/jquery-3.2.1.min.js")"></script>
@if(injectMUI){
    <script src="@routes.Assets.at("javascripts/materialize.min.js")"></script>
}
<script src="@routes.Assets.at("javascripts/jquery-ui.min.js")"></script>
<script>
    $(document).ready(function() {
        $("#vachin-search, #vachin-search-mobile").autocomplete({
            source: function (request, response) {
                var query = request.term;
                $.ajax({
                    url: API_ROOT + "texts/search?q=" + query,
                    success: function (data, textStatus, request) {
                        response($.map(data, function (item) {
                            return {
                                label: item.textItem,
                                value: item._id
                            }
                        }));
                    }
                });
            },
            select: function (event, ui) {
                window.location = "/" + ui.item.value;
                //$.youtubeAPI(ui.item.label);
            }
        });

        //$('.tooltipped').tooltip({delay: 50});

    });
@if(injectMUI) {
    $.ajax({
        url: API_ROOT + "tags",
        success: function (data, textStatus, request) {
            var dataObj = {};
            data.forEach(function (item) {
                dataObj[item._id] = null;
            });
            $(document).ready(function () {
                console.log("Tags", dataObj);
                $('.tags-autocomplete').material_chip({
                    autocompleteOptions: {
                        data: dataObj,
                        limit: Infinity,
                        minLength: 1
                    },
                    placeholder: 'Enter a tag',
                    secondaryPlaceholder: '+Tag'
                });

                var chipsElement = $('.chips');
                var chips = [];

                chipsElement.on('chip.add', function(e, chip){
                    chips.push(chip.tag);
                });

                chipsElement.on('chip.delete', function(e, chip){
                    chips.filter(function (item) {
                        return item !== chip.tag;
                    });
                });

                chipsElement.on('chip.select', function(e, chip){
                    //TODO:
                });

                $("#new-text-form").submit(function (e) {
                    e.preventDefault();
                    var text = $("#new-text").val();
                    if(text.length < 5){
                        Materialize.toast('Please write something to post..!', 4000);
                        return;
                    }
                    var textData = {};
                    textData.text = text;
                    textData.tags = chips;
                    $.ajax({
                        type: "POST",
                        url: "/texts/new",
                        data: JSON.stringify(textData),
                        contentType: "application/json; charset=utf-8",
                        dataType: "text",
                        success: function (data, textStatus, request) {
                            window.location = "/" + data;
                        },
                        error: function(xhr, exception){
                            console.error(exception);
                            Materialize.toast('Message already posted..! Try Another', 4000);
                        }
                    });
                });

            });
        }
    });
}
</script>
</body>
</html>
